<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Appointments</title>
<style>
/* --- GENERAL STYLING --- */
body {
  color: white;
  background-color: #141B34;
  font-family: sans-serif;
  margin: 0;
}
header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  background-color: #141B34;
  border-bottom: 1px solid white;
  padding: 10px 20px;
}
header h1 { margin:0; }
nav ul {
  list-style-type: none;
  display: flex; 
  margin:0;
  padding:0;
}
nav li { margin-left: 20px; }
nav a { color: white; text-decoration: none; }
nav a:hover { text-decoration: underline; }

.appointments { padding: 20px; text-align: center; }
.schedule-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 20px;
  margin-top: 20px;
}
.day {
  background-color: #1F2A52;
  border-radius: 8px;
  padding: 15px;
}
.day h3 {
  border-bottom: 1px solid #444;
  padding-bottom: 8px;
  margin-bottom: 10px;
}
.appointment {
  background-color: #2D3A6A;
  border-radius: 8px;
  padding: 10px;
  margin: 8px 0;
  text-align: left;
  cursor: pointer;
  transition: background-color 0.3s, transform 0.2s;
}
.appointment:hover {
  background-color: #3E4A8A;
  transform: scale(1.03);
}
.appointment span { font-weight: bold; display: block; }
.appointment p { margin: 2px 0 0; font-size: 0.9em; color: #d0d8ff; }

.add-btn, #prevWeek, #nextWeek {
  background-color: #3E4A8A;
  color: white;
  border: none;
  border-radius: 6px;
  padding: 8px 12px;
  margin-top: 10px;
  cursor: pointer;
  font-weight: bold;
  width: 100%;
  transition: background-color 0.3s, transform 0.2s;
}
.add-btn:hover, #prevWeek:hover, #nextWeek:hover {
  background-color: #4E5ABB;
  transform: scale(1.03);
}
.week-nav {
  display: flex;
  justify-content: center;
  align-items: center;
  margin-top: 20px;
  gap: 20px;
}
.week-nav button { width: auto; padding: 10px 20px; }

.modal {
  display: none;
  position: fixed;
  z-index: 10;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  overflow: auto;
  background-color: rgba(0,0,0,0.6);
}
.modal-content {
  background-color: #1F2A52;
  margin: 10% auto;
  padding: 20px;
  border-radius: 10px;
  width: 300px;
  color: white;
  box-shadow: 0 0 10px rgba(0,0,0,0.5);
}
.modal-content h3 { margin-top:0; text-align:center; border-bottom:1px solid #555; padding-bottom:8px;}
.modal-content label { display:block; margin-top:10px; text-align:left; }
.modal-content input, .modal-content select { width:100%; padding:8px; margin-top:5px; border:none; border-radius:5px; }
.submit-btn { width:100%; margin-top:15px; padding:10px; border:none; border-radius:6px; background-color:#3E4A8A; cursor:pointer; font-weight:bold; }
.submit-btn:hover { background-color:#4E5ABB; }

.close { color:#aaa; float:right; font-size:24px; font-weight:bold; cursor:pointer; }
.close:hover { color:white; }

footer { text-align:center; padding:10px; background:#141B34; border-top:1px solid white; margin-top:20px; }

</style>
</head>
<body>

<header>
  <h1>Appointments</h1>
  <nav>
    <ul> 
      <li><a href="index.html">Log Out</a></li>
      <li><a href="realtorportal.html">Home</a></li>
      <li><a href="realtormessages.html">Messages</a></li>
    </ul>
  </nav>
</header> 

<main>
  <section class="appointments">
    <h2 id="weekLabel"></h2>
    <div class="week-nav">
      <button id="prevWeek">Previous Week</button>
      <button id="nextWeek">Next Week</button>
    </div>
    <div class="schedule-grid">
      <div class="day"><h3>Monday</h3><button class="add-btn">+ Add Appointment</button></div>
      <div class="day"><h3>Tuesday</h3><button class="add-btn">+ Add Appointment</button></div>
      <div class="day"><h3>Wednesday</h3><button class="add-btn">+ Add Appointment</button></div>
      <div class="day"><h3>Thursday</h3><button class="add-btn">+ Add Appointment</button></div>
      <div class="day"><h3>Friday</h3><button class="add-btn">+ Add Appointment</button></div>
    </div>
  </section>
</main>

<!-- Add Appointment Modal -->
<div id="appointmentModal" class="modal">
  <div class="modal-content">
    <span class="close">&times;</span>
    <h3>Add New Appointment</h3>
    <form id="appointmentForm">
      <label for="daySelect">Day:</label>
      <select id="daySelect" required>
        <option value="">Select a day</option>
        <option>Monday</option>
        <option>Tuesday</option>
        <option>Wednesday</option>
        <option>Thursday</option>
        <option>Friday</option>
      </select>

      <label for="timeInput">Time:</label>
      <input type="time" id="timeInput" required>

      <label for="addressInput">Address:</label>
      <input type="text" id="addressInput" placeholder="e.g. 123 Main St." required>

      <button type="submit" class="submit-btn">Add Appointment</button>
    </form>
  </div>
</div>

<!-- Edit/Delete Modal -->
<div id="editModal" class="modal">
  <div class="modal-content">
    <span class="close">&times;</span>
    <h3>Edit Appointment</h3>
    <form id="editForm">
      <label>Time:</label>
      <input type="time" id="editTime" required>
      <label>Address:</label>
      <input type="text" id="editAddress" required>
      <button type="submit" class="submit-btn">Save</button>
      <button type="button" id="deleteBtn" class="submit-btn" style="background-color:#bb3e3e;margin-top:5px;">Delete</button>
    </form>
  </div>
</div>

<footer>
  <small>Â© 2025 VillaVista Co.</small>
</footer>

<script>
/* --- WEEK LOGIC --- */
let currentWeekStart = getStartOfWeek(new Date());

function getStartOfWeek(date) {
  const d = new Date(date);
  const day = d.getDay();
  const diff = d.getDate() - day + (day===0?-6:1);
  return new Date(d.setDate(diff));
}

const weekLabel = document.getElementById("weekLabel");

function updateWeekLabel() {
  const options = { month:"numeric", day:"numeric", year:"2-digit" };
  const start = currentWeekStart;
  const end = new Date(start);
  end.setDate(start.getDate()+6);
  weekLabel.innerText = `Week of ${start.toLocaleDateString("en-US", options)} - ${end.toLocaleDateString("en-US", options)}`;
}

/* --- DATA STORAGE --- */
let appointmentsData = {};

/* --- RENDER WEEK APPOINTMENTS --- */
function renderAppointmentsForWeek() {
  const days = document.querySelectorAll(".day");
  const dayNames = ["Monday","Tuesday","Wednesday","Thursday","Friday"];

  days.forEach((dayCol,i)=>{
    // Calculate the date for this day
    const dayDate = new Date(currentWeekStart);
    dayDate.setDate(currentWeekStart.getDate() + i);
    const options = { month: "numeric", day: "numeric", year: "2-digit" };
    const dateStr = dayDate.toLocaleDateString("en-US", options);

    // Update header with day name + date
    dayCol.querySelector("h3").innerText = `${dayNames[i]} ${dateStr}`;

    const dayStr = dayDate.toISOString().split("T")[0]; // for storage key

    // Remove old appointments
    dayCol.querySelectorAll(".appointment").forEach(appt=>appt.remove());

    // Render appointments if any
    if(appointmentsData[dayStr]){
      appointmentsData[dayStr].forEach((appt,index)=>{
        const newAppt = document.createElement("div");
        newAppt.classList.add("appointment");
        newAppt.innerHTML=`<span>${appt.time}</span><p>${appt.address}</p>`;
        newAppt.addEventListener("click",()=>openEditModal(dayStr,index));
        dayCol.insertBefore(newAppt, dayCol.querySelector(".add-btn"));
      });
    }
  });
}

/* --- WEEK NAV BUTTONS --- */
document.getElementById("prevWeek").addEventListener("click",()=>{
  currentWeekStart.setDate(currentWeekStart.getDate()-7);
  updateWeekLabel();
  renderAppointmentsForWeek();
});
document.getElementById("nextWeek").addEventListener("click",()=>{
  currentWeekStart.setDate(currentWeekStart.getDate()+7);
  updateWeekLabel();
  renderAppointmentsForWeek();
});

/* --- ADD MODAL --- */
const addModal = document.getElementById("appointmentModal");
const addButtons = document.querySelectorAll(".add-btn");
const addClose = addModal.querySelector(".close");
const addForm = document.getElementById("appointmentForm");

addButtons.forEach(btn=>btn.addEventListener("click",()=>{
  addModal.style.display="block";
  const dayTitle = btn.parentElement.querySelector("h3").innerText;
  document.getElementById("daySelect").value = dayTitle;
}));
addClose.addEventListener("click",()=>addModal.style.display="none");
window.addEventListener("click",e=>{if(e.target===addModal)addModal.style.display="none";});

addForm.addEventListener("submit", e=>{
  e.preventDefault();
  const day = document.getElementById("daySelect").value;
  const time = document.getElementById("timeInput").value;
  const address = document.getElementById("addressInput").value;

  const dayIndex = ["Monday","Tuesday","Wednesday","Thursday","Friday"].indexOf(day);
  const dayDate = new Date(currentWeekStart);
  dayDate.setDate(currentWeekStart.getDate()+dayIndex);
  const dayStr = dayDate.toISOString().split("T")[0];

  if(!appointmentsData[dayStr]) appointmentsData[dayStr]=[];
  appointmentsData[dayStr].push({time,address});

  addModal.style.display="none";
  addForm.reset();
  renderAppointmentsForWeek();
});

/* --- EDIT/DELETE MODAL --- */
const editModal = document.getElementById("editModal");
const editClose = editModal.querySelector(".close");
const editForm = document.getElementById("editForm");
const editTime = document.getElementById("editTime");
const editAddress = document.getElementById("editAddress");
const deleteBtn = document.getElementById("deleteBtn");

let editDayStr, editIndex;

function openEditModal(dayStrParam,indexParam){
  editDayStr = dayStrParam;
  editIndex = indexParam;
  const appt = appointmentsData[editDayStr][editIndex];
  editTime.value=appt.time;
  editAddress.value=appt.address;
  editModal.style.display="block";
}

editClose.addEventListener("click",()=>{editModal.style.display="none";});
window.addEventListener("click",e=>{if(e.target===editModal)editModal.style.display="none";});

editForm.addEventListener("submit",e=>{
  e.preventDefault();
  appointmentsData[editDayStr][editIndex]={time:editTime.value,address:editAddress.value};
  editModal.style.display="none";
  renderAppointmentsForWeek();
});

deleteBtn.addEventListener("click",()=>{
  appointmentsData[editDayStr].splice(editIndex,1);
  editModal.style.display="none";
  renderAppointmentsForWeek();
});

/* --- INIT --- */
updateWeekLabel();
renderAppointmentsForWeek();

</script>

</body>
</html>
